<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/styles.css">
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="/js/menu.js"></script>
<title>ET마켓</title>
<link rel="icon" href="image/favicon.ico" type="image/x-icon">
<style type="text/css">
    .loginsub{
        font-size: 10pt !important;
    }
    
    .logininput{
        width:300px;
        height: 38px;
        border: 0.7px solid #ddd;
        border-radius: 5px;    
        margin-top: 3px;
        text-indent: 6px;
    }
    
    #btnFindLoginId{
        background-color: #4eb006;
        margin-top:20px; 
        width:300px; 
        height: 45px;
        color: white;
        border-radius: 5px;
        font-size: 11pt !important;
    }
    
    .hidden {
        display: none;
    }
</style>

<script type="text/javascript">
    $(function(){
        
        $("#btnFindLoginId").click(function(event){
            event.preventDefault();
            
            var userEmail = $("#userEmail").val();
            var userPhone = $("#userPhone").val();
            console.log(userEmail + ", " + userPhone);
            
            $.ajax({
                type: "post",
                url: "/member/find/loginIdProcess",
                dataType: "json", // JSON 형식의 응답을 받습니다.
                data: { "userEmail": userEmail, "userPhone": userPhone },
                success: function(response) {
                    if (response.status === "success") {
                        //alert("아이디 찾기 성공: " + response.user.userLoginId);
                        $("#formFields").addClass("hidden");
                        $("#result").removeClass("hidden").text("아이디: " + response.user.userLoginId);
                    } else if (response.status === "error") {
                        $("#error").text(response.message);
                    }
                },
                error: function(xhr, status, error) {
                    console.log("Error response received:", xhr);
                    alert("서버 오류가 발생했습니다. 나중에 다시 시도해주세요.");
                }
            });
        });
        
    });
</script>

</head>
<body>
<div th:replace="fragments/header :: menu1">메뉴1부분</div>

<div th:replace="fragments/header :: menu2">메뉴2부분</div>

    <div align="center" style="margin: 50px 0px 120px 0px;">
    
        <form action="/member/find/findLoginIdProcess" method="post">
            <table style="width: 300px;">
                <tr>
                    <td style="float: left; margin-bottom: 30px;">
                        <h1>아이디 찾기</h1> 
                        <font class="loginsub" style="color: gray;">
                            가입 시 입력한 이메일, 휴대폰번호를 입력해주세요.<br>개인정보보호를 위해 아이디 뒷자리는 *로 표시됩니다.
                        </font>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <div id="result" class="hidden"></div>
                    </td>
                </tr>
        
                <tbody id="formFields" class="ajaxbox">
                    <tr>
                        <td align="left">
                            <div style="margin-bottom: 8px;">
                                <font class="loginsub">이메일</font> <br> 
                                <input type="text" id="userEmail" class="logininput" required="required" placeholder="가입하신 이메일">
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <div style="margin-bottom: 0px; height: 70px;">
                                <font class="loginsub">휴대폰번호</font> <br> 
                                <input type="text" id="userPhone" class="logininput" required="required" placeholder="가입하신 휴대폰번호">
                                
                                <div id="error" class="error" style="color: red;"></div>
                            </div>
                        </td>
                    </tr>
                </tbody>

                <tr>
                    <td>
                        <button type="submit" id="btnFindLoginId" class="loginsub">아이디 찾기</button>
                    </td>
                </tr>
                
            </table>
        </form>
    </div>

    <div th:replace="fragments/footer :: company">기업설명부분</div>
</body>
</html>
